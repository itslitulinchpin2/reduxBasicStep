<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.2.1/redux.js"?></script>
        
    </script>
</head>
<body>

    <div id="subject"></div>
    <div id="toc"></div>
    <div id="control"></div>
    <div id="article"></div>

    <script>
        function subject(){
            document.querySelector('#subject').innerHTML=`
            <header>
                <h1>WEB</h1>
                Hello, WEB! 
             </header>
            `
        }
        
        //재활용 가능하도록 함수화, 즉 부품화 함.

        function toc(){
            var state = store.getState();
            var i=0;
            var litags=''
            while(i<state.contents.length){
                litags=litags+
                `<li> 
                    <a 
                    onclick="
                        event.preventDefault(); 
                        var action={type:'SELECT',id:${state.contents[i].id}}
                        store.dispatch(action);
                    "
                    href="${state.contents[i].id}">
                        ${state.contents[i].title}
                    </a>
                 </li>`
                i=i+1
            }

            document.querySelector('#toc').innerHTML=`
            <nav>
                <ol>
                    ${litags}
                </ol>
            </nav>
            `
        }
      

        function control(){
            document.querySelector('#control').innerHTML=`
            <ul>
                <li><a href="/create">CREATE</a></li>
                <li><input type="button" value="DELETE"></input></li>
            </ul>
            `
        }
     

        function article(){
            var state=store.getState();
            var i=0;
            var aTitle;
            var aDesc;

            while(i<state.contents.length){
                if(state.contents[i].id ===state.selected_id){
                    aTitle=state.contents[i].title
                    aDesc=state.contents[i].desc
                    break;   
                }
                i=i+1;
            }

           

            document.querySelector('#article').innerHTML=`
            <article> 
                <h2>${aTitle}</h2>
                ${aDesc}
            </article>
            `
        }

        function reducer(state,action){
            
            if (state===undefined){
                return {
                selected_id:1,
                 contents:[
                    {id:1, title:'HTML', desc:'HTML is ...'},
                    {id:2, title:'CSS', desc:'CSS is ...'}
                ]   
                } // 객체들의 배열
            } //content를 기반으로 글목록을 표현하자. content는 초기값으로 주자.
            var newState;
            if (action.type==='SELECT'){
                newState=Object.assign({},state,{selected_id:action.id})
            }
            console.log(state,newState)
            return newState;

        }
        var store = Redux.createStore(reducer);
        //store는 전역변수
        //초기 값은 바로 UI에 표시가 된다.
        
        store.subscribe(article)




        subject();
        toc();
        control();
        article();
    </script>

    
    
    
    
    

    
    
</body>
</html>